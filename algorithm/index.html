

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Algorithm &mdash; SCS 3.2.8 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/css/scs_theme.css?v=7d28eb0c" />

  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=6cfee848"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Data equilibration" href="equilibration.html" />
    <link rel="prev" title="Features" href="../index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
              <img src="../_static/scs_logo_transparent.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Algorithm</a><ul>
<li class="toctree-l2"><a class="reference internal" href="equilibration.html">Data equilibration</a></li>
<li class="toctree-l2"><a class="reference internal" href="scale.html">Non-identity DR Scaling</a></li>
<li class="toctree-l2"><a class="reference internal" href="warm_start.html">Caching the workspace and warm-starts</a></li>
<li class="toctree-l2"><a class="reference internal" href="acceleration.html">Acceleration</a></li>
<li class="toctree-l2"><a class="reference internal" href="relaxation.html">Relaxation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#optimality-conditions">Optimality conditions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#certificate-of-infeasibility">Certificate of infeasibility</a></li>
<li class="toctree-l2"><a class="reference internal" href="#termination-criteria">Termination criteria</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id2">Optimality</a></li>
<li class="toctree-l3"><a class="reference internal" href="#infeasibility-cert">Infeasibility</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install/index.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="../linear_solver/index.html">Linear System Solver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../blas_lapack/index.html">BLAS and LAPACK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing/index.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../help/index.html">Help</a></li>
<li class="toctree-l1"><a class="reference internal" href="../citing/index.html">Citing SCS</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">SCS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Algorithm</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/algorithm/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="algorithm">
<span id="id1"></span><h1>Algorithm<a class="headerlink" href="#algorithm" title="Link to this heading"></a></h1>
<div class="toctree-wrapper compound">
</div>
<p>SCS applies Douglas-Rachford splitting to a homogeneous embedding
of the quadratic cone program. The high level algorithm is as follows,
from an initial <span class="math notranslate nohighlight">\(w^0\)</span> for <span class="math notranslate nohighlight">\(k=0,1,\ldots\)</span> do</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\tilde u^{k+1} &amp;= (I + \mathcal{Q})^{-1} w^k\\
u^{k+1} &amp;= \Pi_{\mathcal{C}_+}(2\tilde u^{k+1} - w^k)\\
w^{k+1} &amp;= w^k + u^{k+1} - \tilde u^{k+1}
\end{align}\end{split}\]</div>
<p>which yields <span class="math notranslate nohighlight">\(w^k \rightarrow u^\star + \mathcal{Q}(u^\star)\)</span> where
<span class="math notranslate nohighlight">\(0 \in \mathcal{Q}(u^\star) + N_{\mathcal{C}_+}(u^\star)\)</span>, and <span class="math notranslate nohighlight">\(u^k
\rightarrow u^\star\)</span> from which we can recover the <a class="reference internal" href="#optimality"><span class="std std-ref">optimal solution</span></a> or a <a class="reference internal" href="#infeasibility"><span class="std std-ref">certificate of infeasibility</span></a> (such a
<span class="math notranslate nohighlight">\(u^\star\)</span> is guaranteed to exist). Note that this is slightly different to
the formulation in the original <a class="reference external" href="https://web.stanford.edu/~boyd/papers/scs.html">paper</a>, and corresponds to the
latest algorithm described <a class="reference external" href="https://arxiv.org/abs/2004.02177">here</a>.  The
algorithm consists of three steps.  The first step involves <a class="reference internal" href="../linear_solver/index.html#linear-solver"><span class="std std-ref">solving a
linear system</span></a> of equations:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{bmatrix} I + P &amp; A^T  \\ A &amp; -I \end{bmatrix}\begin{bmatrix} x \\ y
\end{bmatrix} = \begin{bmatrix} \mu_x \\ -\mu_y \end{bmatrix}\end{split}\]</div>
<p>The second step is the Euclidean projection onto a convex <a class="reference internal" href="../api/cones.html#cones"><span class="std std-ref">cone</span></a>, ie,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{ll}
\mbox{minimize} &amp; \| z - z_0\|_2^2 \\
\mbox{subject to } &amp; z \in \mathcal{K}
\end{array}\end{split}\]</div>
<p>over variable <span class="math notranslate nohighlight">\(z\)</span>. Many cones of interest have relatively simple
projection operators.</p>
<section id="optimality-conditions">
<span id="optimality"></span><h2>Optimality conditions<a class="headerlink" href="#optimality-conditions" title="Link to this heading"></a></h2>
<p>SCS solves problems of the form:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{lcr}
\begin{array}{ll}
\mbox{minimize} &amp; (1/2)x^\top  P x + c^\top  x\\
\mbox{subject to} &amp;  Ax + s = b\\
  &amp; s \in \mathcal{K}
\end{array}
&amp;\quad&amp;
\begin{array}{ll}
\mbox{maximize} &amp; -(1/2)x^\top  P x - b^\top  y\\
\mbox{subject to} &amp;  Px + A^\top y + c = 0\\
  &amp; y \in \mathcal{K}^*
\end{array}
\end{array}\end{split}\]</div>
<p>When strong duality holds, the Karush-Kuhn-Tucker (KKT) conditions
are <a class="reference external" href="https://web.stanford.edu/~boyd/cvxbook/">necessary and sufficient for optimality</a>. They are given by</p>
<div class="math notranslate nohighlight">
\[Ax + s = b, \quad Px + A^\top y + c = 0,\quad s \in \mathcal{K}, \quad y \in \mathcal{K}^*,\quad  s \perp y.\]</div>
<p>These are primal feasibility, dual feasibility, primal and dual cone membership,
and complementary slackness.  The complementary slackness condition is
equivalent to a zero <em>duality gap</em> condition at any optimal point, that is
for <span class="math notranslate nohighlight">\((x,y,s)\)</span> that satisfy the KKT conditions we have</p>
<div class="math notranslate nohighlight">
\[s\perp y \ \Leftrightarrow \ c^\top x + b^\top y + x^\top P x = 0.\]</div>
</section>
<section id="certificate-of-infeasibility">
<span id="infeasibility"></span><h2>Certificate of infeasibility<a class="headerlink" href="#certificate-of-infeasibility" title="Link to this heading"></a></h2>
<p>On the other hand, if no optimal solution exists then SCS is able to robustly detect primal or dual infeasibility.
Any <span class="math notranslate nohighlight">\(y \in \mathbf{R}^m\)</span> that satisfies</p>
<div class="math notranslate nohighlight">
\[A^\top y = 0,\  y \in \mathcal{K}^*,\ b^\top y &lt; 0\]</div>
<p>acts a certificate that the quadratic cone program is primal infeasible (dual unbounded). On the other hand, if we can find <span class="math notranslate nohighlight">\(x \in \mathbf{R}^n\)</span> such
that</p>
<div class="math notranslate nohighlight">
\[Px = 0,\ -Ax\in \mathcal{K},\ c^\top x &lt; 0\]</div>
<p>then this is a certificate that the problem is dual infeasible (primal
unbounded).</p>
</section>
<section id="termination-criteria">
<span id="termination"></span><h2>Termination criteria<a class="headerlink" href="#termination-criteria" title="Link to this heading"></a></h2>
<section id="id2">
<h3>Optimality<a class="headerlink" href="#id2" title="Link to this heading"></a></h3>
<p>The iterates produced by SCS <em>always</em> satisfy the conic constraints <span class="math notranslate nohighlight">\(s \in
\mathcal{K}, y \in \mathcal{K}^*, s \perp y\)</span>.  Therefore to say that a problem
is solved we need to check if the primal residual, dual residual, and duality
gap are all below a certain tolerance. Specifically, SCS terminates when it has
found <span class="math notranslate nohighlight">\(x \in \mathbf{R}^n\)</span>, <span class="math notranslate nohighlight">\(s \in \mathbf{R}^m\)</span>, and <span class="math notranslate nohighlight">\(y \in
\mathbf{R}^m\)</span> that satisfy the following residual bounds.</p>
<ul class="simple">
<li><p>Primal residual:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[r_p := \|Ax + s - b\|_\infty \leq \epsilon_\mathrm{abs} + \epsilon_\mathrm{rel} \max(\|Ax\|_\infty, \|s\|_\infty, \|b\|_\infty)\]</div>
<ul class="simple">
<li><p>Dual residual:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[r_d := \|Px + A^\top y + c \|_\infty \leq \epsilon_\mathrm{abs} + \epsilon_\mathrm{rel} \max(\|Px\|_\infty, \|A^\top y\|_\infty, \|c\|_\infty)\]</div>
<ul class="simple">
<li><p>Duality gap:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[r_g := |x^\top Px + c^\top x + b^\top y| \leq \epsilon_\mathrm{abs} + \epsilon_\mathrm{rel} \max(|x^\top P x|, |c^\top x|, |b^\top y|),\]</div>
<p>where <span class="math notranslate nohighlight">\(\epsilon_\mathrm{abs}&gt;0\)</span> and <span class="math notranslate nohighlight">\(\epsilon_\mathrm{rel}&gt;0\)</span> are
user defined <a class="reference internal" href="../api/settings.html#settings"><span class="std std-ref">settings</span></a>. The <span class="math notranslate nohighlight">\(\ell_\infty\)</span> norm
here can be changed to other norms by changing the definition of <code class="code docutils literal notranslate"><span class="pre">NORM</span></code> in
the <code class="code docutils literal notranslate"><span class="pre">include/glbopts.h</span></code> file.</p>
</section>
<section id="infeasibility-cert">
<span id="id3"></span><h3>Infeasibility<a class="headerlink" href="#infeasibility-cert" title="Link to this heading"></a></h3>
<p>Since the conic constraints are always guaranteed by the iterates (<span class="math notranslate nohighlight">\(s \in
\mathcal{K}, y \in \mathcal{K}^*, s \perp y\)</span>), SCS
declares a problem <strong>primal infeasible (dual unbounded)</strong> when it finds <span class="math notranslate nohighlight">\(y \in
\mathbf{R}^m\)</span> that satisfies</p>
<div class="math notranslate nohighlight">
\[b^\top y = -1, \quad \|A^\top y\|_\infty &lt; \epsilon_\mathrm{infeas}.\]</div>
<p>Similarly, SCS declares a problem <strong>dual infeasible (primal unbounded)</strong> when it finds
<span class="math notranslate nohighlight">\(x \in \mathbf{R}^n\)</span>, <span class="math notranslate nohighlight">\(s \in \mathbf{R}^m\)</span> that satisfy</p>
<div class="math notranslate nohighlight">
\[c^\top x = -1, \quad  \max(\|P x\|_\infty, \|A x + s\|_\infty) &lt; \epsilon_\mathrm{infeas}\]</div>
<p>where <span class="math notranslate nohighlight">\(\epsilon_\mathrm{infeas} &gt; 0\)</span> is a user-defined <a class="reference internal" href="../api/settings.html#settings"><span class="std std-ref">setting</span></a>.  The <span class="math notranslate nohighlight">\(\ell_\infty\)</span> norm here can be changed to other norms by
changing the definition of <code class="code docutils literal notranslate"><span class="pre">NORM</span></code> in the <code class="code docutils literal notranslate"><span class="pre">include/glbopts.h</span></code> file.</p>
<p>In some rare cases a problem is both primal and dual infeasible. In this case
SCS will return one of the two above certificates, whichever one it finds
first. However, in that case the interpretation of infeasibility in one space
being equivalent to unboundedness in the dual space does not hold.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../index.html" class="btn btn-neutral float-left" title="Features" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="equilibration.html" class="btn btn-neutral float-right" title="Data equilibration" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Brendan O&#39;Donoghue.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-9CY7R8S5N2"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-9CY7R8S5N2', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>